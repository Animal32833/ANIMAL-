<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANIMAL - Nutrición Personalizada</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Librería para gráficas de progreso -->
    <script src="script.js" defer></script> <!-- Asegúrate de que el script se cargue correctamente -->

    <!-- Estilos CSS Incrustados -->
    <style>
        /* General Styles */
        body {
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            min-height: 100vh; /* Esto asegura que el contenido esté centrado verticalmente */
        }

        /* Header and Logo */
        header {
            padding: 20px;
            background-color: #121212;
        }

        .logo img {
            width: 150px;
        }

        h1 {
            color: #39FF14; /* Verde neón */
            margin: 20px 0;
        }

        #hero h2 {
            font-size: 2rem;
            margin-bottom: 20px;
        }

        #hero p {
            font-size: 1.2rem;
        }

        /* Form Section */
        #form-section {
            padding: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        form {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #333;
            padding: 20px;
            border-radius: 10px;
            width: 100%;
            max-width: 400px; /* Limita el tamaño máximo del formulario */
        }

        label, input, select {
            display: block;
            width: 100%;
            margin: 10px 0;
        }

        input, select {
            padding: 10px;
            border: none;
            border-radius: 5px;
        }

        button {
            background-color: #39FF14;
            color: black;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
        }

        button:hover {
            background-color: #32cd32;
        }

        /* Gallery Section */
        #gallery {
            padding: 40px;
        }

        .image-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }

        .image-container img {
            width: 30%;
            margin: 10px;
            border-radius: 10px;
        }

        /* Footer */
        footer {
            background-color: #121212;
            padding: 20px;
            color: #777;
        }

        footer p {
            margin: 0;
        }

        /* Estilos para el menú generado */
        .menu-container {
            margin-top: 20px;
            text-align: left;
            width: 100%;
            max-width: 600px;
        }

        .nutrition-info {
            display: none;
            background-color: #444;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">
            <img src="logo-animal.png" alt="Animal Logo">
        </div>
        <h1>ANIMAL - Nutrición Personalizada</h1>
    </header>

    <!-- Sección de bienvenida -->
    <section id="hero">
        <h2>Bienvenido a tu plan personalizado de nutrición y entrenamiento</h2>
        <p>Introduce tus datos para obtener un plan acorde a tus objetivos y necesidades.</p>
    </section>

    <!-- Formulario de Nutrición -->
    <section id="form-section">
        <form id="nutricionForm">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" required>

            <label for="edad">Edad:</label>
            <input type="number" id="edad" required>

            <label for="peso">Peso (kg):</label>
            <input type="number" id="peso" required>

            <label for="altura">Altura (cm):</label>
            <input type="number" id="altura" required>

            <label for="genero">Género:</label>
            <select id="genero" required>
                <option value="masculino">Masculino</option>
                <option value="femenino">Femenino</option>
            </select>

            <label for="objetivo">Objetivo:</label>
            <select id="objetivo" required>
                <option value="mantener_peso">Mantener Peso</option>
                <option value="perder_peso">Perder Peso</option>
                <option value="ganar_masa">Ganar Masa Muscular</option>
            </select>

            <label for="restricciones">Restricciones alimenticias (opcional):</label>
            <input type="text" id="restricciones" placeholder="Ej. sin gluten, vegetariano">

            <button type="submit">Generar Opciones de Comida</button>
        </form>

        <!-- Mostrar la recomendación de agua -->
        <p id="resultadoAgua"></p>
    </section>

    <!-- Opciones de Menú generadas -->
    <section id="menus">
        <h2>Opciones de Menú</h2>
        <div id="resultadoDieta"></div>
    </section>

    <!-- Seguimiento de Progreso -->
    <section id="progreso">
        <h2>Seguimiento de Progreso</h2>
        <form id="progresoForm">
            <label for="dni">DNI:</label>
            <input type="text" id="dni" required>

            <label for="peso">Peso (kg):</label>
            <input type="number" id="peso" required>

            <label for="medidaCintura">Medida de Cintura (cm):</label>
            <input type="number" id="medidaCintura" required>

            <label for="medidaCadera">Medida de Cadera (cm):</label>
            <input type="number" id="medidaCadera">

            <button type="submit">Registrar Progreso</button>
        </form>

        <!-- Gráfico de Progreso -->
        <canvas id="graficoProgreso"></canvas>
    </section>

    <!-- Cargar Progreso por DNI -->
    <section id="cargarProgreso">
        <h2>Cargar Progreso por DNI</h2>
        <form id="cargarProgresoForm">
            <label for="dniCargar">DNI:</label>
            <input type="text" id="dniCargar" required>
            <button type="submit">Cargar Progreso</button>
        </form>
    </section>

    <!-- JavaScript -->
    <script>
        let graficoProgreso;

        // Función para calcular la TMB (Tasa Metabólica Basal)
        function calcularTMB(peso, altura, edad, genero) {
            if (genero === 'masculino') {
                return Math.round(88.36 + (13.4 * peso) + (4.8 * altura) - (5.7 * edad));
            } else {
                return Math.round(447.6 + (9.2 * peso) + (3.1 * altura) - (4.3 * edad));
            }
        }

        // Función para calcular la ingesta de agua recomendada
        function calcularIngestaAgua(peso) {
            return (peso * 0.035).toFixed(2); // 35 ml por kg de peso
        }

        // Base de datos de recetas con restricciones alimenticias y objetivos de nutrición
        const recetas = [
            { nombre: "Avena con Frutas", calorias: 350, proteinas: 10, carbohidratos: 60, grasas: 5, restricciones: ["sin gluten", "vegetariano"], tipo: "desayuno", objetivos: ["mantener_peso", "ganar_masa"], ingredientes: [{nombre: "Avena", gramos: 50}, {nombre: "Frutas", gramos: 100}] },
            { nombre: "Tostadas con Aguacate", calorias: 250, proteinas: 5, carbohidratos: 30, grasas: 15, restricciones: ["vegano", "sin gluten"], tipo: "desayuno", objetivos: ["mantener_peso", "perder_peso"], ingredientes: [{nombre: "Tostadas", gramos: 60}, {nombre: "Aguacate", gramos: 100}] },
            { nombre: "Pollo a la Parrilla con Arroz", calorias: 500, proteinas: 40, carbohidratos: 60, grasas: 10, restricciones: ["sin gluten"], tipo: "almuerzo", objetivos: ["mantener_peso", "ganar_masa"], ingredientes: [{nombre: "Pollo", gramos: 200}, {nombre: "Arroz", gramos: 150}] },
            { nombre: "Lasaña de Berenjena", calorias: 400, proteinas: 30, carbohidratos: 30, grasas: 15, restricciones: ["vegetariano"], tipo: "almuerzo", objetivos: ["perder_peso", "mantener_peso"], ingredientes: [{nombre: "Berenjena", gramos: 200}, {nombre: "Queso", gramos: 100}] },
           const recetas = [
    // Desayunos
    { nombre: "Avena con Frutas", calorias: 350, proteinas: 10, carbohidratos: 60, grasas: 5, restricciones: ["sin gluten", "vegetariano"], tipo: "desayuno", objetivos: ["mantener_peso", "ganar_masa"] },
    { nombre: "Tostadas con Aguacate", calorias: 250, proteinas: 5, carbohidratos: 30, grasas: 15, restricciones: ["vegano", "sin gluten"], tipo: "desayuno", objetivos: ["mantener_peso", "perder_peso"] }, 
    { nombre: "Batido de Proteínas con Plátano", calorias: 300, proteinas: 25, carbohidratos: 30, grasas: 10, restricciones: ["sin gluten", "vegetariano"], tipo: "desayuno", objetivos: ["ganar_masa"] },
    { nombre: "Tortilla de Claras con Espinaca", calorias: 200, proteinas: 20, carbohidratos: 5, grasas: 5, restricciones: ["sin gluten", "vegetariano"], tipo: "desayuno", objetivos: ["mantener_peso", "perder_peso"] },
    { nombre: "Smoothie de Fresas y Yogur", calorias: 150, proteinas: 10, carbohidratos: 30, grasas: 2, restricciones: ["sin gluten"], tipo: "desayuno", objetivos: ["perder_peso"] },
    { nombre: "Pan Integral con Mermelada", calorias: 180, proteinas: 6, carbohidratos: 35, grasas: 3, restricciones: ["vegetariano"], tipo: "desayuno", objetivos: ["mantener_peso"] },
    { nombre: "Huevos Revueltos con Jamón", calorias: 300, proteinas: 20, carbohidratos: 5, grasas: 20, restricciones: ["sin gluten"], tipo: "desayuno", objetivos: ["ganar_masa"] },
    { nombre: "Porridge de Avena con Frutos Rojos", calorias: 350, proteinas: 12, carbohidratos: 60, grasas: 5, restricciones: ["vegetariano"], tipo: "desayuno", objetivos: ["mantener_peso", "ganar_masa"] },
    { nombre: "Yogur Griego con Miel", calorias: 250, proteinas: 15, carbohidratos: 30, grasas: 5, restricciones: ["vegetariano"], tipo: "desayuno", objetivos: ["mantener_peso", "ganar_masa"] },
    { nombre: "Bagel Integral con Queso Crema", calorias: 400, proteinas: 15, carbohidratos: 60, grasas: 15, restricciones: ["vegetariano"], tipo: "desayuno", objetivos: ["ganar_masa"] },

    // Almuerzos
    { nombre: "Pollo a la Parrilla con Arroz", calorias: 500, proteinas: 40, carbohidratos: 60, grasas: 10, restricciones: ["sin gluten"], tipo: "almuerzo", objetivos: ["mantener_peso", "ganar_masa"], acompanamiento: "Ensalada de verduras" },
    { nombre: "Ensalada de Quinoa y Vegetales", calorias: 400, proteinas: 15, carbohidratos: 60, grasas: 10, restricciones: ["vegano", "sin gluten"], tipo: "almuerzo", objetivos: ["perder_peso", "mantener_peso"], acompanamiento: "Pan sin gluten" },
    { nombre: "Wrap de Pollo", calorias: 450, proteinas: 35, carbohidratos: 45, grasas: 15, restricciones: ["sin gluten"], tipo: "almuerzo", objetivos: ["mantener_peso", "ganar_masa"], acompanamiento: "Papas asadas" },
    { nombre: "Tacos de Pavo con Guacamole", calorias: 500, proteinas: 40, carbohidratos: 50, grasas: 15, restricciones: ["sin gluten"], tipo: "almuerzo", objetivos: ["ganar_masa"], acompanamiento: "Arroz integral" },
    { nombre: "Bowl de Atún con Vegetales", calorias: 450, proteinas: 40, carbohidratos: 40, grasas: 15, restricciones: ["sin gluten"], tipo: "almuerzo", objetivos: ["mantener_peso", "ganar_masa"], acompanamiento: "Ensalada mixta" },
    { nombre: "Lasaña de Berenjena", calorias: 400, proteinas: 30, carbohidratos: 30, grasas: 15, restricciones: ["vegetariano"], tipo: "almuerzo", objetivos: ["perder_peso", "mantener_peso"], acompanamiento: "Pan integral" },
    { nombre: "Pechuga de Pavo con Verduras", calorias: 350, proteinas: 45, carbohidratos: 20, grasas: 10, restricciones: ["sin gluten"], tipo: "almuerzo", objetivos: ["perder_peso", "mantener_peso"], acompanamiento: "Puré de batatas" },
    { nombre: "Arroz Integral con Frijoles", calorias: 450, proteinas: 15, carbohidratos: 80, grasas: 5, restricciones: ["vegano", "sin gluten"], tipo: "almuerzo", objetivos: ["mantener_peso"], acompanamiento: "Ensalada verde" },
    { nombre: "Sándwich de Pollo a la Parrilla", calorias: 500, proteinas: 35, carbohidratos: 50, grasas: 15, restricciones: ["sin gluten"], tipo: "almuerzo", objetivos: ["mantener_peso", "ganar_masa"], acompanamiento: "Papas horneadas" },
    { nombre: "Hamburguesa de Lentejas", calorias: 400, proteinas: 20, carbohidratos: 60, grasas: 10, restricciones: ["vegano", "sin gluten"], tipo: "almuerzo", objetivos: ["mantener_peso", "perder_peso"], acompanamiento: "Puré de papa" },

    // Cenas
    { nombre: "Salmón al Horno", calorias: 450, proteinas: 40, carbohidratos: 5, grasas: 30, restricciones: ["sin gluten", "pescatariano"], tipo: "cena", objetivos: ["mantener_peso", "ganar_masa"], acompanamiento: "Espárragos asados" },
    { nombre: "Tofu Salteado con Verduras", calorias: 350, proteinas: 20, carbohidratos: 30, grasas: 10, restricciones: ["vegano", "sin gluten"], tipo: "cena", objetivos: ["perder_peso", "mantener_peso"], acompanamiento: "Arroz integral" },
    { nombre: "Pechuga de Pollo Asada", calorias: 400, proteinas: 45, carbohidratos: 20, grasas: 10, restricciones: ["sin gluten"], tipo: "cena", objetivos: ["mantener_peso", "ganar_masa"], acompanamiento: "Verduras al vapor" },
    { nombre: "Pizza de Coliflor", calorias: 400, proteinas: 20, carbohidratos: 40, grasas: 15, restricciones: ["vegetariano", "sin gluten"], tipo: "cena", objetivos: ["mantener_peso", "perder_peso"], acompanamiento: "Ensalada mixta" },
    { nombre: "Tilapia al Limón", calorias: 300, proteinas: 35, carbohidratos: 5, grasas: 15, restricciones: ["sin gluten", "pescatariano"], tipo: "cena", objetivos: ["mantener_peso", "perder_peso"], acompanamiento: "Arroz integral" },

    // Snacks
    { nombre: "Yogur con Almendras", calorias: 200, proteinas: 10, carbohidratos: 20, grasas: 10, restricciones: ["sin gluten", "vegetariano"], tipo: "snack", objetivos: ["mantener_peso"] },
    { nombre: "Frutas con Mantequilla de Almendra", calorias: 250, proteinas: 5, carbohidratos: 40, grasas: 10, restricciones: ["vegano", "sin gluten"], tipo: "snack", objetivos: ["mantener_peso", "perder_peso"] },
    { nombre: "Barra de Proteína Casera", calorias: 300, proteinas: 25, carbohidratos: 30, grasas: 15, restricciones: ["sin gluten"], tipo: "snack", objetivos: ["ganar_masa"] },
    { nombre: "Hummus con Palitos de Zanahoria", calorias: 150, proteinas: 5, carbohidratos: 15, grasas: 5, restricciones: ["vegano", "sin gluten"], tipo: "snack", objetivos: ["mantener_peso", "perder_peso"] },
    { nombre: "Nueces Mixtas", calorias: 250, proteinas: 5, carbohidratos: 10, grasas: 20, restricciones: ["vegano", "sin gluten"], tipo: "snack", objetivos: ["mantener_peso", "ganar_masa"] }
];

        ];

        // Función para generar automáticamente el menú completo del día con botón para información nutricional
        function generarMenuAutomatico(caloriasDiarias, restriccionesUsuario, objetivo) {
            const comidasDiarias = ['desayuno', 'almuerzo', 'cena', 'snack'];
            let menuCompleto = `<h3>Menú del día:</h3><div class="menu-container">`;

            comidasDiarias.forEach(comida => {
                const recetasFiltradas = recetas.filter(receta => {
                    const cumpleRestricciones = restriccionesUsuario
                        ? receta.restricciones.includes(restriccionesUsuario.toLowerCase())
                        : true;
                    const cumpleObjetivo = receta.objetivos.includes(objetivo);
                    return receta.tipo === comida && cumpleRestricciones && cumpleObjetivo;
                });

                if (recetasFiltradas.length > 0) {
                    const recetaSeleccionada = recetasFiltradas[Math.floor(Math.random() * recetasFiltradas.length)];
                    menuCompleto += `
                        <div>
                            <p><strong>${comida.charAt(0).toUpperCase() + comida.slice(1)}:</strong> ${recetaSeleccionada.nombre} (${recetaSeleccionada.calorias} calorías)</p>
                            <button class="toggle-button">Ver información nutricional</button>
                            <div class="nutrition-info">
                                <p><strong>Proteínas:</strong> ${recetaSeleccionada.proteinas} g</p>
                                <p><strong>Carbohidratos:</strong> ${recetaSeleccionada.carbohidratos} g</p>
                                <p><strong>Grasas:</strong> ${recetaSeleccionada.grasas} g</p>
                                <p><strong>Ingredientes:</strong></p>
                                <ul>
                                    ${recetaSeleccionada.ingredientes.map(ing => `<li>${ing.nombre}: ${ing.gramos}g</li>`).join('')}
                                </ul>
                            </div>
                        </div>`;
                } else {
                    menuCompleto += `<p><strong>${comida.charAt(0).toUpperCase() + comida.slice(1)}:</strong> No hay opciones disponibles para tus restricciones.</p>`;
                }
            });

            menuCompleto += `</div>`;
            return menuCompleto;
        }

        // Manejar el envío del formulario de nutrición
        const nutricionForm = document.getElementById("nutricionForm");
        if (nutricionForm) {
            nutricionForm.addEventListener("submit", function(event) {
                event.preventDefault();

                const nombre = document.getElementById("nombre").value;
                const edad = document.getElementById("edad").value;
                const peso = document.getElementById("peso").value;
                const altura = document.getElementById("altura").value;
                const genero = document.getElementById("genero").value;
                const objetivo = document.getElementById("objetivo").value;
                const restricciones = document.getElementById("restricciones").value;

                const bmr = calcularTMB(peso, altura, edad, genero);
                let caloriasDiarias;
                if (objetivo === "perder_peso") {
                    caloriasDiarias = bmr * 1.2 - 500;
                } else if (objetivo === "ganar_masa") {
                    caloriasDiarias = bmr * 1.5 + 300;
                } else {
                    caloriasDiarias = bmr * 1.2;
                }

                const ingestaAgua = calcularIngestaAgua(peso);
                const resultadoAgua = document.getElementById("resultadoAgua");
                if (resultadoAgua) {
                    resultadoAgua.textContent = `Te recomendamos beber ${ingestaAgua} litros de agua al día.`;
                }

                const menuGenerado = generarMenuAutomatico(caloriasDiarias, restricciones, objetivo);
                const resultadoDieta = document.getElementById("resultadoDieta");
                if (resultadoDieta) {
                    resultadoDieta.innerHTML = menuGenerado;
                }

                // Asignar comportamiento a los botones para ver la información nutricional
                document.querySelectorAll('.toggle-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const info = button.nextElementSibling;
                        info.style.display = info.style.display === 'block' ? 'none' : 'block';
                    });
                });
            });
        }

        // Función para manejar el progreso
        const progresoForm = document.getElementById("progresoForm");
        if (progresoForm) {
            progresoForm.addEventListener("submit", function(event) {
                event.preventDefault();
                const dni = document.getElementById("dni").value;
                const peso = document.getElementById("peso").value;
                const medidaCintura = document.getElementById("medidaCintura").value;
                const medidaCadera = document.getElementById("medidaCadera").value;

                const progresoUsuario = {
                    peso,
                    medidaCintura,
                    medidaCadera,
                    fecha: new Date().toLocaleDateString()
                };

                let progresos = JSON.parse(localStorage.getItem(dni)) || [];
                progresos.push(progresoUsuario);
                localStorage.setItem(dni, JSON.stringify(progresos));

                mostrarGraficoProgreso(dni);
            });
        }

        // Función para cargar y mostrar el gráfico de progreso del usuario
        function mostrarGraficoProgreso(dni) {
            const progresos = JSON.parse(localStorage.getItem(dni)) || [];
            const datosProgreso = {
                labels: progresos.map((progreso, index) => `Registro ${index + 1}`),
                datasets: [{
                    label: 'Peso (kg)',
                    data: progresos.map(progreso => progreso.peso),
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 2
                }]
            };

            const ctx = document.getElementById('graficoProgreso');
            if (graficoProgreso) {
                graficoProgreso.destroy();
            }
            if (ctx) {
                graficoProgreso = new Chart(ctx.getContext('2d'), {
                    type: 'line',
                    data: datosProgreso,
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: false
                            }
                        }
                    }
                });
            }
        }

        // Cargar el progreso por DNI
        const cargarProgresoForm = document.getElementById("cargarProgresoForm");
        if (cargarProgresoForm) {
            cargarProgresoForm.addEventListener("submit", function(event) {
                event.preventDefault();
                const dni = document.getElementById("dniCargar").value;
                mostrarGraficoProgreso(dni);
            });
        }
    </script>
</body>
</html>
